let base64 = require('base-64');
let username = "<%= ENV['watson_username'] %>";
let data = "<%= @document_text %>";
let url = "https://gateway.watsonplatform.net/tone-analyzer/api/v3/tone?version=2017-09-21";
let password = "<%= ENV['watson_password'] %>";
let headers = new Headers();
debugger
headers.set('Authorization', 'Basic ' + base64.encode(username + ":" + password));
headers.set('Content-Type', 'text/plain;charset=utf-8')

$('.watson_button').on('click', function(){
    fetch(url, { method: 'POST',
                  body: JSON.stringify(data),
                  headers: headers
})
.then(res => res.json())
.catch(error => console.error('Error:', error))
.then(response => console.log('Success:', response));
});
